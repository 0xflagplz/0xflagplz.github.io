<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Domain Fronting</title>
</head><body><div style="text-align: left"><br/>
We as an attacker would like a request to a high reputable domain<br/>
&quot;safedomain&quot; to NOT go to &quot;safedomain&quot; origin server.<br/>
<b>how do we get the normal domain to redirect to <span style="color: #ff0000">our malicious origin host<br/>
</span><span style="color: #ff0000"/><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><img height="288" src="image.png" width="350"/></li>
</ul>
</li>
</ul>
<br/>
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br/>
</b><br/>
<u><span style="font-size: 16pt"><b>How do CDN work?</b></span></u><br/>
</div><div style="text-align: left">Client making a request to <b>something backed by the</b><b>CDN</b></div><ul><li style="list-style-type: none">the client does a DNS lookup and gets back the IP address associated with CDN</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none"><img height="283" src="image 2.png" width="400"/></li>
</ul>
</li>
</ul>
<br/>
<br/>
<span style="font-size: 18pt"><b><div style="text-align: left"><u>How to exploit?</u></div></b></span><ul><div style="text-align: left"><span style="font-size: 16pt"><li style="list-style-type: none">We need to change the HTTP host header</li>
</span><li style="list-style-type: none"><span style="font-size: 16pt">Client will make request to approved domain but redirect to our Origin Server</span></li>
</div></ul>
<br/>
<ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><img height="323" src="image 3.png" width="450"/>	<img height="311" src="image 4.png" width="450"/>	<img height="288" src="image 5.png" width="400"/></li>
<li style="list-style-type: none"/>
<li style="list-style-type: none"/>
<li style="list-style-type: none"><ul><li style="list-style-type: none"><img src="image 6.png"/>	<img src="image 7.png"/></li>
</ul>
</li>
<li style="list-style-type: none"/>
</ul>
</li>
<li style="list-style-type: none"/>
</ul>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>